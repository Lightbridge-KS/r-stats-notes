{
  "hash": "fc540ab0efb232a4e4fc4abe01971e2d",
  "result": {
    "markdown": "---\ntitle: \"Sample Size (2)\"\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(pwr)\nlibrary(WebPower)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: MASS\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'MASS'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    select\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: lme4\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: Matrix\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'Matrix'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:tidyr':\n\n    expand, pack, unpack\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: lavaan\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThis is lavaan 0.6-16\nlavaan is FREE software! Please report any bugs.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: parallel\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: PearsonDS\n```\n:::\n\n```{.r .cell-code}\nlibrary(simstudy)\n```\n:::\n\n\n**Sources:**\n\n- [RMRWR CH 19](https://bookdown.org/pdr_higgins/rmrwr/sample-size-calculations-with-pwr.html#sample-size-for-a-continuous-endpoint-t-test)\n\n- [Sample size calculation in clinical trial using R](https://doi.org/10.7602/jmis.2023.26.1.9)\n\n## Overview\n\n![Functions & packages for Sample Size](/pic/sample-size/sample-size-pkg-2.png)\n\n### Typical Values\n\n- A two-tailed test\n- a significance of **0.05** and a power of **80%** was established. \n\n- For **nonparametric tests** on continuous variables, as a rule of thumb, calculate the sample size required for parametric tests and **add 15%**\n\n### Effect Size\n\n- Effect size can be defined as ‘a standardized measure of the magnitude of the mean difference or relationship between study groups’\n\n- An index that divides the effect size by its dispersion (standard deviation, etc.) is not affected by the measurement unit and can be used regardless of the unit, and is called an ‘effect size index’ or ‘standardized effect size\n\n- Whether an effect size should be interpreted as small, medium, or large may depend on the analysis method. \n\n\n- We use the guidelines mentioned by Cohen and Sawilowsky and use the medium effect size considered for each test in the examples below.\n\n### Conventional Effect Size\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncohen.ES(test = \"t\", size = \"medium\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n     Conventional effect size from Cohen (1982) \n\n           test = t\n           size = medium\n    effect.size = 0.5\n```\n:::\n:::\n\n\n## Continuous outcome\n\n`pwr.t.test()` function\n\n- one-sample t test (type = “one.sample”)\n- two-sample t test (type = “two.sample”)\n- paired t test (type = “paired”).\n\n**Cohen’s d** is used as the effect size\n\n- Very small (d = 0.01)\n- Small (d = 0.2)\n- Medium (d = 0.5)\n- Large (d = 0.8)\n- Very large (d = 1.2)\n- Huge (d = 2)\n\nIn our example, we will use medium effect size (d = 0.5).\n\n\n### One-sample t-test \n\nCohen's d:\n\n$$\nd = \\frac{\\mu_1 - \\mu_0}{SD}\n$$\n\nWhere:\n\n- $\\mu_0$ = mean under $H_0$\n- $\\mu_1$ = mean under $H_1$\n- $SD$ = SD under $H_0$\n\n### Ex 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\npwr.t.test(d = 0.5, sig.level = 0.05, power = 0.8, type = \"one.sample\", alternative = \"two.sided\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n     One-sample t test power calculation \n\n              n = 33.36713\n              d = 0.5\n      sig.level = 0.05\n          power = 0.8\n    alternative = two.sided\n```\n:::\n:::\n\n\n**N = 34** (If dropout rate of 20%, a total of 43 samples are required) \n\n\n\n### Ex 2: New DM Drug\n\nLet’s propose a study of a new drug to reduce hemoglobin A1c in type 2 diabetes over a 1 year study period. You estimate that your recruited participants will have a mean baseline A1c of 9.0, which will be unchanged by your placebo, but reduced (on average) to 7.0 by the study drug.\n\nlet’s say 5.0 and 17.0 for min and max of Hgb A1c\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsd_approx <- (17 - 5)/4\nd1 <- (9 - 7) / sd_approx # delta / sd\n\npwr::pwr.t.test(n = NULL,\n                sig.level = 0.05, \n                type = \"two.sample\", \n                alternative = \"two.sided\", \n                power = 0.80, \n                d = d1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n     Two-sample t test power calculation \n\n              n = 36.30569\n              d = 0.6666667\n      sig.level = 0.05\n          power = 0.8\n    alternative = two.sided\n\nNOTE: n is number in *each* group\n```\n:::\n:::\n\n\n**N = 37** in each group (Assuming a 20% dropout rate in each arm, would require 37*5/4 subjects per arm)\n\n\nIf study on 50 participants, what would the power be?\n\n\n::: {.cell}\n\n```{.r .cell-code}\npwr::pwr.t.test(n = 25, # note that n is per arm\n                sig.level = 0.05, \n                type = \"two.sample\", \n                alternative = \"two.sided\", \n                power = NULL, # ?\n                d = 0.66)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n     Two-sample t test power calculation \n\n              n = 25\n              d = 0.66\n      sig.level = 0.05\n          power = 0.6280322\n    alternative = two.sided\n\nNOTE: n is number in *each* group\n```\n:::\n:::\n\n\n## Proprotion\n\nLet’s assume that patients discharged from your hospital after a myocardial infarction have historically received a prescription for aspirin 80% of the time. A nursing quality improvement project on the cardiac floor has tried to increase this rate to 95%. How many patients do you need to track after the QI intervention to determine if the proportion has truly increased?\n\n- the null hypothesis is that the proportion is 0.8\n\n- the alternative hypothesis is that the proportion is 0.95.\n\n\nEffect size of: `2*asin(sqrt(p1))-2*asin(sqrt(p2))`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nES.h(p1 = 0.95, p2 = 0.80)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.4762684\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npwr.p.test(h = ES.h(p1 = 0.95, p2 = 0.80),\n           n = NULL,\n           sig.level = 0.05,\n           power = 0.80,\n           alternative = \"greater\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n     proportion power calculation for binomial distribution (arcsine transformation) \n\n              h = 0.4762684\n              n = 27.25616\n      sig.level = 0.05\n          power = 0.8\n    alternative = greater\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
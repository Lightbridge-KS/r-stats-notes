{
  "hash": "a6a69a77dd82ac00b863201e617b1ffd",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Inter-rator\"\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(irr)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: lpSolve\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'lpSolve' was built under R version 4.3.3\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(yardstick)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'yardstick'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:readr':\n\n    spec\n```\n\n\n:::\n:::\n\n\n\n\n- [Inter-rater reliability](https://www.andywills.info/rminr/irr.html)\n\n- [DataNovia](https://www.datanovia.com/en/lessons/inter-rater-reliability-analyses-quick-r-codes/)\n\n## Cohen Kappa\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Diagnoses data\ndata(\"diagnoses\", package = \"irr\")\ndiagnoses\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    rater1                  rater2                  rater3\n1              4. Neurosis             4. Neurosis             4. Neurosis\n2  2. Personality Disorder 2. Personality Disorder 2. Personality Disorder\n3  2. Personality Disorder        3. Schizophrenia        3. Schizophrenia\n4                 5. Other                5. Other                5. Other\n5  2. Personality Disorder 2. Personality Disorder 2. Personality Disorder\n6            1. Depression           1. Depression        3. Schizophrenia\n7         3. Schizophrenia        3. Schizophrenia        3. Schizophrenia\n8            1. Depression           1. Depression        3. Schizophrenia\n9            1. Depression           1. Depression             4. Neurosis\n10                5. Other                5. Other                5. Other\n11           1. Depression             4. Neurosis             4. Neurosis\n12           1. Depression 2. Personality Disorder             4. Neurosis\n13 2. Personality Disorder 2. Personality Disorder 2. Personality Disorder\n14           1. Depression             4. Neurosis             4. Neurosis\n15 2. Personality Disorder 2. Personality Disorder             4. Neurosis\n16        3. Schizophrenia        3. Schizophrenia        3. Schizophrenia\n17           1. Depression           1. Depression           1. Depression\n18           1. Depression           1. Depression           1. Depression\n19 2. Personality Disorder 2. Personality Disorder             4. Neurosis\n20           1. Depression        3. Schizophrenia        3. Schizophrenia\n21                5. Other                5. Other                5. Other\n22 2. Personality Disorder             4. Neurosis             4. Neurosis\n23 2. Personality Disorder 2. Personality Disorder             4. Neurosis\n24           1. Depression           1. Depression             4. Neurosis\n25           1. Depression             4. Neurosis             4. Neurosis\n26 2. Personality Disorder 2. Personality Disorder 2. Personality Disorder\n27           1. Depression           1. Depression           1. Depression\n28 2. Personality Disorder 2. Personality Disorder             4. Neurosis\n29           1. Depression        3. Schizophrenia        3. Schizophrenia\n30                5. Other                5. Other                5. Other\n                    rater4                  rater5                  rater6\n1              4. Neurosis             4. Neurosis             4. Neurosis\n2                 5. Other                5. Other                5. Other\n3         3. Schizophrenia        3. Schizophrenia                5. Other\n4                 5. Other                5. Other                5. Other\n5              4. Neurosis             4. Neurosis             4. Neurosis\n6         3. Schizophrenia        3. Schizophrenia        3. Schizophrenia\n7         3. Schizophrenia                5. Other                5. Other\n8         3. Schizophrenia        3. Schizophrenia             4. Neurosis\n9              4. Neurosis             4. Neurosis             4. Neurosis\n10                5. Other                5. Other                5. Other\n11             4. Neurosis             4. Neurosis             4. Neurosis\n12             4. Neurosis             4. Neurosis             4. Neurosis\n13        3. Schizophrenia        3. Schizophrenia        3. Schizophrenia\n14             4. Neurosis             4. Neurosis             4. Neurosis\n15             4. Neurosis             4. Neurosis                5. Other\n16        3. Schizophrenia        3. Schizophrenia                5. Other\n17             4. Neurosis                5. Other                5. Other\n18           1. Depression           1. Depression 2. Personality Disorder\n19             4. Neurosis             4. Neurosis             4. Neurosis\n20                5. Other                5. Other                5. Other\n21                5. Other                5. Other                5. Other\n22             4. Neurosis             4. Neurosis             4. Neurosis\n23                5. Other                5. Other                5. Other\n24             4. Neurosis             4. Neurosis             4. Neurosis\n25             4. Neurosis             4. Neurosis                5. Other\n26 2. Personality Disorder 2. Personality Disorder             4. Neurosis\n27           1. Depression                5. Other                5. Other\n28             4. Neurosis             4. Neurosis             4. Neurosis\n29        3. Schizophrenia        3. Schizophrenia        3. Schizophrenia\n30                5. Other                5. Other                5. Other\n```\n\n\n:::\n:::\n\n\n\n\n### Plot\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncm_r1r2 <- conf_mat(diagnoses, truth = rater1, estimate = rater2)\nautoplot(cm_r1r2, type = \"heatmap\")\n```\n\n::: {.cell-output-display}\n![](cor-icc_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n### Calculate Cohen’s kappa\n \nThe Cohen’s kappa corresponds to the unweighted kappa. It can be used for two nominal or two ordinal categorical variables\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndiagnoses |> \n  select(rater1, rater2) |> \n  kappa2(weight = \"unweighted\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Cohen's Kappa for 2 Raters (Weights: unweighted)\n\n Subjects = 30 \n   Raters = 2 \n    Kappa = 0.651 \n\n        z = 7 \n  p-value = 2.63e-12 \n```\n\n\n:::\n:::\n\n\n\n\n\n## Intraclass correlation coefficient (ICC)\n\n### DataNovia\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"anxiety\", package = \"irr\")\nhead(anxiety, 4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  rater1 rater2 rater3\n1      3      3      2\n2      3      6      1\n3      3      4      4\n4      4      6      4\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nicc(\n  anxiety, model = \"twoway\", \n  type = \"agreement\", unit = \"single\"\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Single Score Intraclass Correlation\n\n   Model: twoway \n   Type : agreement \n\n   Subjects = 20 \n     Raters = 3 \n   ICC(A,1) = 0.198\n\n F-Test, H0: r0 = 0 ; H1: r0 > 0 \n F(19,39.7) = 1.83 , p = 0.0543 \n\n 95%-Confidence Interval for ICC Population Values:\n  -0.039 < ICC < 0.494\n```\n\n\n:::\n:::\n\n\n\n\n\n### Radiomics Example\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Simulated radiomics features data for 5 subjects and 2 observers\nradiomics_data <- data.frame(\n  Subject = 1:5,\n  Observer1_Feature1 = c(0.75, 0.82, 0.91, 0.85, 0.88),\n  Observer2_Feature1 = c(0.73, 0.83, 0.89, 0.86, 0.87),\n  Observer1_Feature2 = c(100, 102, 105, 108, 107),\n  Observer2_Feature2 = c(99, 101, 104, 109, 106)\n)\n\nradiomics_data\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Subject Observer1_Feature1 Observer2_Feature1 Observer1_Feature2\n1       1               0.75               0.73                100\n2       2               0.82               0.83                102\n3       3               0.91               0.89                105\n4       4               0.85               0.86                108\n5       5               0.88               0.87                107\n  Observer2_Feature2\n1                 99\n2                101\n3                104\n4                109\n5                106\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ICC for Feature 1 across both observers\nfeature1_data <- radiomics_data[, c(\"Observer1_Feature1\", \"Observer2_Feature1\")]\nicc_feature1 <- icc(feature1_data, \n                    model = \"twoway\", \n                    type = \"agreement\", \n                    unit = \"single\")\n\nicc_feature1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Single Score Intraclass Correlation\n\n   Model: twoway \n   Type : agreement \n\n   Subjects = 5 \n     Raters = 2 \n   ICC(A,1) = 0.972\n\n F-Test, H0: r0 = 0 ; H1: r0 > 0 \n  F(4,4.95) = 66.4 , p = 0.000171 \n\n 95%-Confidence Interval for ICC Population Values:\n  0.805 < ICC < 0.997\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nradiomics_data |> \n  ggplot(aes(Observer1_Feature1, Observer2_Feature1)) +\n  geom_point() + \n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](cor-icc_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "cor-icc_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
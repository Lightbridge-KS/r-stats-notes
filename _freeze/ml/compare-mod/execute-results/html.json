{
  "hash": "79baea000a9b65fe8d32cda49bdfd217",
  "result": {
    "markdown": "---\ntitle: \"Comparing Models\"\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(here)\nlibrary(tidyverse)\nlibrary(tidymodels)\n\ntidymodels_prefer()\n```\n:::\n\n\n\n[Compare model with resampling](https://www.tmwr.org/compare)\n\n## Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(ames)\names <- ames %>% mutate(Sale_Price = log10(Sale_Price))\n\nset.seed(502)\names_split <- initial_split(ames, prop = 0.80, strata = Sale_Price)\names_train <- training(ames_split)\names_test  <-  testing(ames_split)\n\names_folds <- vfold_cv(ames_train, v = 10)\n```\n:::\n\n\n\n## Recipes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbasic_rec <- \n  recipe(Sale_Price ~ Neighborhood + Gr_Liv_Area + Year_Built + Bldg_Type + \n           Latitude + Longitude, data = ames_train) %>%\n  step_log(Gr_Liv_Area, base = 10) %>% \n  step_other(Neighborhood, threshold = 0.01) %>% \n  step_dummy(all_nominal_predictors())\n\ninteraction_rec <- \n  basic_rec %>% \n  step_interact( ~ Gr_Liv_Area:starts_with(\"Bldg_Type_\") ) \n\nspline_rec <- \n  interaction_rec %>% \n  step_ns(Latitude, Longitude, deg_free = 50)\n\n# List of Recipes \npreproc <- \n  list(basic = basic_rec, \n       interact = interaction_rec, \n       splines = spline_rec\n  )\n```\n:::\n\n\n## Models\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmspecs <- list(\n  lm = linear_reg()\n)\n\nclass(mspecs$lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"linear_reg\" \"model_spec\"\n```\n:::\n:::\n\n\n\n## Workflows\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_models <- workflow_set(preproc, mspecs, cross = FALSE)\nclass(lm_models)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"workflow_set\" \"tbl_df\"       \"tbl\"          \"data.frame\"  \n```\n:::\n\n```{.r .cell-code}\nlm_models\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A workflow set/tibble: 3 × 4\n  wflow_id    info             option    result    \n  <chr>       <list>           <list>    <list>    \n1 basic_lm    <tibble [1 × 4]> <opts[0]> <list [0]>\n2 interact_lm <tibble [1 × 4]> <opts[0]> <list [0]>\n3 splines_lm  <tibble [1 × 4]> <opts[0]> <list [0]>\n```\n:::\n:::\n\n\n## Fit Workflows\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_wfs <- \n  lm_models %>% \n  workflow_map(\"fit_resamples\", \n               # Options to `workflow_map()`: \n               seed = 1101, verbose = TRUE,\n               # Options to `fit_resamples()`: \n               resamples = ames_folds, \n               control = control_resamples(save_pred = T))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\ni 1 of 3 resampling: basic_lm\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ 1 of 3 resampling: basic_lm (1.8s)\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\ni 2 of 3 resampling: interact_lm\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ 2 of 3 resampling: interact_lm (1.8s)\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\ni 3 of 3 resampling: splines_lm\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ 3 of 3 resampling: splines_lm (3.2s)\n```\n:::\n\n```{.r .cell-code}\nclass(lm_wfs)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"workflow_set\" \"tbl_df\"       \"tbl\"          \"data.frame\"  \n```\n:::\n\n```{.r .cell-code}\nlm_wfs\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A workflow set/tibble: 3 × 4\n  wflow_id    info             option    result   \n  <chr>       <list>           <list>    <list>   \n1 basic_lm    <tibble [1 × 4]> <opts[2]> <rsmp[+]>\n2 interact_lm <tibble [1 × 4]> <opts[2]> <rsmp[+]>\n3 splines_lm  <tibble [1 × 4]> <opts[2]> <rsmp[+]>\n```\n:::\n:::\n\n\n## Metric\n\nMetric for each workflows\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm_wfs_metrics <- collect_metrics(lm_wfs)\nlm_wfs_metrics\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 9\n  wflow_id    .config      preproc model .metric .estimator   mean     n std_err\n  <chr>       <chr>        <chr>   <chr> <chr>   <chr>       <dbl> <int>   <dbl>\n1 basic_lm    Preprocesso… recipe  line… rmse    standard   0.0804    10 0.00313\n2 basic_lm    Preprocesso… recipe  line… rsq     standard   0.793     10 0.0122 \n3 interact_lm Preprocesso… recipe  line… rmse    standard   0.0800    10 0.00301\n4 interact_lm Preprocesso… recipe  line… rsq     standard   0.795     10 0.0114 \n5 splines_lm  Preprocesso… recipe  line… rmse    standard   0.0786    10 0.00288\n6 splines_lm  Preprocesso… recipe  line… rsq     standard   0.802     10 0.0120 \n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}